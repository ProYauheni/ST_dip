{% extends 'base.html' %}

{% block content %}
<style>
  .contact-info {
    font-size: 1.1rem;
  }
  .section-title {
    color: #000000;
    font-weight: 600;
    margin-bottom: 1rem;
    text-align: center;

    letter-spacing: 0.05em;
  }
  .contact-row {
    display: flex;
    flex-wrap: wrap;
    gap: 2rem;
    justify-content: center;
    margin-bottom: 3rem;
  }
  .contact-card {
    background: #f9fafb;
    border-radius: 15px;
    box-shadow: 0 4px 12px rgb(72 94 116 / 0.1);
    padding: 1.75rem 2rem;
    flex: 1 1 320px;
    max-width: 600px;
    transition: box-shadow 0.3s ease;
  }
  .contact-card:hover {
    box-shadow: 0 6px 18px rgb(72 94 116 / 0.15);
  }
  .contact-group-title {
    font-weight: 600;
    color: #2f855a;
    margin-bottom: 0.75rem;
    border-bottom: 2px solid #68d391;
    padding-bottom: 0.25rem;
  }
  .contact-details p, .contact-details li {
    font-size: 1rem;
    margin-bottom: 0.3rem;
    color: #2d3748;
  }
  .contact-details ul {
    padding-left: 1.2rem;
  }
  .btn-custom-primary {
    background-color: #38a169;
    color: #fff;
    border: none;
    padding: 0.5rem 1.5rem;
    border-radius: 0.5rem;
    font-weight: 600;
    transition: background-color 0.3s ease;
  }
  .btn-custom-primary:hover {
    background-color: #2f855a;
    color: #fff;
  }
  .messenger-link {
    display: inline-block;
    color: #6b46c1;
    font-weight: 700;
    text-decoration: underline;
    font-size: 1.1rem;
    transition: color 0.3s ease, text-decoration 0.3s ease;
  }
  .messenger-link:hover {
    color: #553c9a;
    text-decoration: none;
  }
</style>

<div class="container py-4">
  <h2 class="section-title">Контакты СТ «{{ community.name }}»</h2>

  <div class="contact-row">
    <!-- Левая колонка -->
    <div class="contact-card">
      <div class="contact-group-title">Председатель правления</div>
      <div class="contact-details">
        {% if contacts.chairman %}
          {% if contacts.chairman.full_name or contacts.chairman.plot_number or contacts.chairman.phone %}
            <p>
              {{ contacts.chairman.full_name }}
              {% if contacts.chairman.plot_number %}, участок №{{ contacts.chairman.plot_number }}{% endif %}
              {% if contacts.chairman.phone %}, ☎{{ contacts.chairman.phone }}{% endif %}
            </p>
          {% else %}
            <p class="text-muted">Информация отсутствует.</p>
          {% endif %}
        {% else %}
          <p class="text-muted">Информация отсутствует.</p>
        {% endif %}
      </div>

      <div class="contact-group-title mt-4">Казначей</div>
      <div class="contact-details">
        {% if contacts.treasurer %}
          {% if contacts.treasurer.full_name or contacts.treasurer.plot_number or contacts.treasurer.phone %}
            <p>
              {{ contacts.treasurer.full_name }}
              {% if contacts.treasurer.plot_number %}, участок №{{ contacts.treasurer.plot_number }}{% endif %}
              {% if contacts.treasurer.phone %}, ☎{{ contacts.treasurer.phone }}{% endif %}
            </p>
          {% else %}
            <p class="text-muted">Информация отсутствует.</p>
          {% endif %}
        {% else %}
          <p class="text-muted">Информация отсутствует.</p>
        {% endif %}
      </div>

      <div class="contact-group-title mt-4">Члены правления</div>
      <div class="contact-details">
        {% if contacts.board_members %}
          <ul class="list-unstyled">
            {% for member in contacts.board_members %}
              {% if member.full_name or member.plot_number or member.phone %}
                <li>
                  {{ member.full_name }}
                  {% if member.plot_number %}, участок №{{ member.plot_number }}{% endif %}
                  {% if member.phone %}, ☎{{ member.phone }}{% endif %}
                </li>
              {% endif %}
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-muted">Информация отсутствует.</p>
        {% endif %}
      </div>

      <div class="contact-group-title mt-4">Ответственный за электрохозяйство</div>
      <div class="contact-details">
        {% if contacts.electricity_manager %}
          {% if contacts.electricity_manager.full_name or contacts.electricity_manager.plot_number or contacts.electricity_manager.phone %}
            <p>
              {{ contacts.electricity_manager.full_name }}
              {% if contacts.electricity_manager.plot_number %}, участок №{{ contacts.electricity_manager.plot_number }}{% endif %}
              {% if contacts.electricity_manager.phone %}, ☎{{ contacts.electricity_manager.phone }}{% endif %}
            </p>
          {% else %}
            <p class="text-muted">Информация отсутствует.</p>
          {% endif %}
        {% else %}
          <p class="text-muted">Информация отсутствует.</p>
        {% endif %}
      </div>

      <div class="contact-group-title mt-4">Ответственный за водохозяйство</div>
      <div class="contact-details">
        {% if contacts.water_manager %}
          {% if contacts.water_manager.full_name or contacts.water_manager.plot_number or contacts.water_manager.phone %}
            <p>
              {{ contacts.water_manager.full_name }}
              {% if contacts.water_manager.plot_number %}, участок №{{ contacts.water_manager.plot_number }}{% endif %}
              {% if contacts.water_manager.phone %}, ☎{{ contacts.water_manager.phone }}{% endif %}
            </p>
          {% else %}
            <p class="text-muted">Информация отсутствует.</p>
          {% endif %}
        {% else %}
          <p class="text-muted">Информация отсутствует.</p>
        {% endif %}
      </div>
    </div>

    <!-- Правая колонка -->
    <div class="contact-card">
      <div class="contact-group-title">Юридический адрес</div>
      <p>{{ community.legal_address|linebreaksbr }}</p>

      <div class="contact-group-title mt-4">Почтовый адрес</div>
      <p>{{ community.postal_address|linebreaksbr }}</p>

      <div class="contact-group-title mt-4">Банковские реквизиты</div>
      <p>{{ community.bank_details|linebreaksbr }}</p>

      {% if community.additional_info %}
        <div class="contact-group-title mt-4">Дополнительная информация</div>
        <p>{{ community.additional_info|linebreaksbr }}</p>
      {% endif %}

      {% if community.messenger_group_link %}
        <div class="text-center mt-4">
          <a href="{{ community.messenger_group_link }}" target="_blank" rel="noopener noreferrer" class="messenger-link">
            Присоединиться к группе в мессенджере Viber
          </a>
        </div>
      {% endif %}

      {% if user.profile.role == 'chairman' %}
        <div class="text-center mt-5">
          <a href="{% url 'community_contacts_edit_all' %}" class="btn btn-custom-primary">Редактировать все контактные данные</a>
        </div>
      {% elif user.profile.role == 'board_member' %}
        <div class="text-center mt-5">
          <a href="{% url 'community_contact_edit' %}" class="btn btn-custom-primary">Редактировать контактную информацию</a>
        </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
